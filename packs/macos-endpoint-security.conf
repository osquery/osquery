{
  "platform": "darwin",
  "version": "1.0.0",
  "queries": {
    "es_process_events": {
      "query": "SELECT * FROM es_process_events;",
      "interval": 300,
      "description": "Process events from EndpointSecurity.",
      "removed": false
    },
    "es_process_file_events": {
      "query": "SELECT * FROM es_process_file_events;",
      "interval": 300,
      "description": "File events from EndpointSecurity.",
      "removed": false
    },
    "es_auth_failed_logins": {
      "query": "SELECT time, username, event_type, auth_type, path, description FROM es_authentication_events WHERE success = 0;",
      "interval": 300,
      "description": "Failed authentication attempts from EndpointSecurity.",
      "removed": false
    },
    "es_auth_ssh_logins": {
      "query": "SELECT time, username, ssh_login_username, remote_address, result_type, success FROM es_authentication_events WHERE event_type = 'openssh_login';",
      "interval": 300,
      "description": "SSH login attempts from EndpointSecurity.",
      "removed": false
    },
    "es_auth_sudo_usage": {
      "query": "SELECT time, username, sudo_command, success FROM es_authentication_events WHERE event_type = 'sudo';",
      "interval": 300,
      "description": "Sudo command usage from EndpointSecurity.",
      "removed": false
    },
    "es_auth_su_usage": {
      "query": "SELECT time, username, su_from_username, su_to_username, success FROM es_authentication_events WHERE event_type = 'su';",
      "interval": 300,
      "description": "Su command usage from EndpointSecurity.",
      "removed": false
    },
    "es_auth_screensharing": {
      "query": "SELECT time, username, event_type, screensharing_type, screensharing_viewer_app_path, remote_address FROM es_authentication_events WHERE event_type LIKE 'screensharing%';",
      "interval": 300,
      "description": "Screen sharing sessions from EndpointSecurity.",
      "removed": false
    }
  }
}